Option Explicit

'Function main()
'
'    Dim projectPath As String
'    Dim path_emailTriggerConfig_Excel As String
'    Dim path_emailTriggerConfig_DownloadScript As String
'
'    path_emailTriggerConfig_Excel = "D:\Email macros\Parameterization\Email Trigger Config.xlsx"
'    path_emailTriggerConfig_DownloadScript = "D:\Email macros\Parameterization\DownloadEmailTriggerConfig.bat"
'
'    'Config File Download
'    downloadEmailTriggerConfig (path_emailTriggerConfig_DownloadScript)
'
''   path_emailTriggerConfig_Excel = "E:\Email macros\Parameterization\Email Trigger Config.xlsx"
'
'    'Form Project path
'    projectPath = fetchParamValueFromExcel(path_emailTriggerConfig_Excel, "apiKey", "pc-auto4") & "\" & fetchVerifiedBuildVersionFromTextFile(fetchParamValueFromExcel(path_emailTriggerConfig_Excel, "projectVerifiedVersionFilePath", "pc-auto4"))
'
'  Debug.Print projectPath
''    MsgBox projectPath
'
'End Function

Function downloadEmailTriggerConfig(downloadCommand As String)
        
    Dim strCommand As String
    Dim lngErrorCode As Long
    Dim wsh As WshShell
    Set wsh = New WshShell
        
    'Run the batch file using the WshShell object
    strCommand = Chr(34) & downloadCommand & Chr(34)
    
    lngErrorCode = wsh.Run(strCommand, windowStyle:=1, waitOnReturn:=True)
    If lngErrorCode <> 0 Then
        'MsgBox "Error! Something went wrong with the batch execution!"
    Else
        'Call Mail_PostExecution_Text_Outlook(platformEnv)
    End If

End Function

Function fetchParamValueFromExcel(ExcelFilePath As String, param As String, pcName As String) As String

    Dim objExcel As New Excel.Application
    Dim exWb As Excel.Workbook
    Dim exWs As Excel.Worksheet
    Dim exWsFn As Excel.WorksheetFunction
    
    Dim rowNo As Integer
    Dim columnNo As Integer
    
    Set exWb = objExcel.Workbooks.Open(ExcelFilePath)
    
    rowNo = exWb.Sheets("Email Trigger Config").Range("A:A").Find(what:=param, lookat:=xlWhole).row
    columnNo = exWb.Sheets("Email Trigger Config").Range("1:1").Find(what:=pcName, lookat:=xlWhole).Column
    
    'MsgBox exWb.Sheets("report").Cells(rowNo, columnNo)
    
    fetchParamValueFromExcel = exWb.Sheets("Email Trigger Config").Cells(rowNo, columnNo)
    
    objExcel.Workbooks.Close
    
ExitRoutine:
        Set exWb = Nothing
        Set objExcel = Nothing
    
End Function
    
Function fetchVerifiedBuildVersionFromTextFile(VersionFilePath As String) As String
    
    Dim textline As String
    Dim text As String
    
    Open VersionFilePath For Input As #1
    
    Do Until EOF(1)
        Line Input #1, textline
        text = text & textline
        'MsgBox text
    Loop
    
    fetchVerifiedBuildVersionFromTextFile = text
    
    Close #1

End Function


Public Function hostName() As String

Dim sHostName As String
' Get Host Name / Get Computer Name
sHostName = Environ$("computername")
Debug.Print sHostName
hostName = sHostName
End Function

