Public Sub runBatch(MyMail As MailItem)
Dim msgInBody As String
Dim msgBodyForQA As String
Dim msgBodyForStaging As String
Dim msgBodyForPreProd As String
Dim msgBodyForProd As String
Dim subject As String
Dim platformEnv As String

subject = LCase(MyMail.subject)

Debug.Print subject

   If (InStr(1, subject, "re:") = 0 And InStr(1, subject, "fw:") = 0) Then
        If InStr(1, subject, "golive:qa") > 0 Then
            MsgBox "QA environment"
            platformEnv = "qa"
        ElseIf (InStr(1, subject, "golive:staging") > 0) Then
            MsgBox "Staging environment"
            platformEnv = "staging-azure"
        Else
            Exit Sub
            
'          Shell "C:\Users\dhoosa\Desktop\qam.bat"
'         ElseIf (InStr(1, subject, "golive:preprod") > 0) Then
'            MsgBox "Pre-prod environment"
'            platformEnv = "pre-prod"
' '          Shell "C:\Users\dhoosa\Desktop\qam.bat"
'         ElseIf (InStr(1, subject, "golive:prod") > 0) Then
'            MsgBox "Production environment"
'            platformEnv = "prod"
'          Shell "C:\Users\dhoosa\Desktop\qam.bat"
    End If
    
    TextFile_Create platformEnv
    Debug.Print "TextFile"
    Shell "C:\Users\dhoosa\Desktop\MyFile.bat"
    Debug.Print "batch File started "
    End If
End Sub

Public Sub TextFile_Create(platformEnv As String)
'Public Sub TextFile_Create()

Dim BatchFile As Integer
Dim FilePath As String
Dim command1 As String
Dim command2 As String
Dim command3 As String
Dim valueOfEnvironment As String
Dim valueOfProfileName As String
Dim testSuitePath As String
Dim projectPath As String
Dim browserName As String
Dim batchFileCreationPath As String
Dim preExecutionCommand As String

Debug.Print "Platform environment in file creation is :" & platformEnv

projectPath = Chr(34) & "E:\TFS\QA Automations\IdealSpacesAutomation\IdealSpaces 6.0\Script v4.x\Script v4.x.prj" & Chr(34)
browserName = Chr(34) & "Chrome" & Chr(34)
batchFileCreationPath = "C:\Users\dhoosa\Desktop\MyFile.bat"
valueOfProfileName = Chr(34) & "2020 Metric" & Chr(34)
'valueOfProfileName = Chr(34) & "Cabinets.com" & Chr(34)
testSuitePath = Chr(34) & "Test Suites/2020 Metric" & Chr(34)
valueOfEnvironment = Chr(34) & platformEnv & Chr(34)
katalonDriveName = "E:"
katalonPath = "Katalon setup\Katalon_Studio_Windows_64-6.1.1 (2)\Katalon_Studio_Windows_64-6.1.1"

Debug.Print valueOfProfileName

If (valueOfProfileName = Chr(34) & "Cabinets.com" & Chr(34) And platformEnv = "staging-azure") Then
    valueOfEnvironment = Chr(34) & "staging-aws" & Chr(34)
End If

'Debug.Print "Value of environment is " & valueOfEnvironment
'Debug.Print "batchFileLocation--> " & batchFileCreationPath
'Debug.Print platformEnv

command1 = katalonDriveName
command2 = "cd " & katalonPath
'command3 = "katalon -noSplash  -runMode=console -consoleLog -noExit -projectPath=""E:\TFS\QA Automations\IdealSpacesAutomation\IdealSpaces 6.0\Script v4.x\Script v4.x.prj"" -retry=0 -testSuitePath=""Test Suites/2020 Metric"" -executionProfile=""2020 Metric"" -browserType=""Chrome"" -g_platformEnv=""staging-azure"""
command3 = "katalon -noSplash  -runMode=console -consoleLog -noExit -projectPath=" & projectPath & " -retry=0 -testSuitePath=" & testSuitePath & " -executionProfile=" & valueOfProfileName & " -browserType=" & browserName & " -g_platformEnv =" & valueOfEnvironment

Debug.Print "Command 3 -->" & command3

  FilePath = batchFileCreationPath

  BatchFile = FreeFile

  Open FilePath For Output As BatchFile

  Print #BatchFile, command1
  Print #BatchFile, command2
  Print #BatchFile, command3

  Close BatchFile

End Sub

